{
	"name": "Notebook 1",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "spark2zy8loi",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "c51b84a4-324a-431e-b56c-48b0f7ab677c"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"81dce6d6-d514-4c3a-9374-b174f93ddab6": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "771",
										"1": "Mountain-100 Silver, 38",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "772",
										"1": "Mountain-100 Silver, 42",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "773",
										"1": "Mountain-100 Silver, 44",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "774",
										"1": "Mountain-100 Silver, 48",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "775",
										"1": "Mountain-100 Black, 38",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "776",
										"1": "Mountain-100 Black, 42",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "777",
										"1": "Mountain-100 Black, 44",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "778",
										"1": "Mountain-100 Black, 48",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "779",
										"1": "Mountain-200 Silver, 38",
										"2": "Mountain Bikes",
										"3": "2319.9900"
									},
									{
										"0": "780",
										"1": "Mountain-200 Silver, 42",
										"2": "Mountain Bikes",
										"3": "2319.9900"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "ProductID",
										"type": "string"
									},
									{
										"key": "1",
										"name": "ProductName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "Category",
										"type": "string"
									},
									{
										"key": "3",
										"name": "ListPrice",
										"type": "string"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"ee23f45a-d5aa-4178-88b0-56be41441bb9": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "771",
										"1": "Mountain-100 Silver, 38",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "772",
										"1": "Mountain-100 Silver, 42",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "773",
										"1": "Mountain-100 Silver, 44",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "774",
										"1": "Mountain-100 Silver, 48",
										"2": "Mountain Bikes",
										"3": "3399.9900"
									},
									{
										"0": "775",
										"1": "Mountain-100 Black, 38",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "776",
										"1": "Mountain-100 Black, 42",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "777",
										"1": "Mountain-100 Black, 44",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "778",
										"1": "Mountain-100 Black, 48",
										"2": "Mountain Bikes",
										"3": "3374.9900"
									},
									{
										"0": "779",
										"1": "Mountain-200 Silver, 38",
										"2": "Mountain Bikes",
										"3": "2319.9900"
									},
									{
										"0": "780",
										"1": "Mountain-200 Silver, 42",
										"2": "Mountain Bikes",
										"3": "2319.9900"
									},
									{
										"0": "781",
										"1": "Mountain-200 Silver, 46",
										"2": "Mountain Bikes",
										"3": "2319.9900"
									},
									{
										"0": "782",
										"1": "Mountain-200 Black, 38",
										"2": "Mountain Bikes",
										"3": "2294.9900"
									},
									{
										"0": "783",
										"1": "Mountain-200 Black, 42",
										"2": "Mountain Bikes",
										"3": "2294.9900"
									},
									{
										"0": "784",
										"1": "Mountain-200 Black, 46",
										"2": "Mountain Bikes",
										"3": "2294.9900"
									},
									{
										"0": "785",
										"1": "Mountain-300 Black, 38",
										"2": "Mountain Bikes",
										"3": "1079.9900"
									},
									{
										"0": "786",
										"1": "Mountain-300 Black, 40",
										"2": "Mountain Bikes",
										"3": "1079.9900"
									},
									{
										"0": "787",
										"1": "Mountain-300 Black, 44",
										"2": "Mountain Bikes",
										"3": "1079.9900"
									},
									{
										"0": "788",
										"1": "Mountain-300 Black, 48",
										"2": "Mountain Bikes",
										"3": "1079.9900"
									},
									{
										"0": "980",
										"1": "Mountain-400-W Silver, 38",
										"2": "Mountain Bikes",
										"3": "769.4900"
									},
									{
										"0": "981",
										"1": "Mountain-400-W Silver, 40",
										"2": "Mountain Bikes",
										"3": "769.4900"
									},
									{
										"0": "982",
										"1": "Mountain-400-W Silver, 42",
										"2": "Mountain Bikes",
										"3": "769.4900"
									},
									{
										"0": "983",
										"1": "Mountain-400-W Silver, 46",
										"2": "Mountain Bikes",
										"3": "769.4900"
									},
									{
										"0": "984",
										"1": "Mountain-500 Silver, 40",
										"2": "Mountain Bikes",
										"3": "564.9900"
									},
									{
										"0": "985",
										"1": "Mountain-500 Silver, 42",
										"2": "Mountain Bikes",
										"3": "564.9900"
									},
									{
										"0": "986",
										"1": "Mountain-500 Silver, 44",
										"2": "Mountain Bikes",
										"3": "564.9900"
									},
									{
										"0": "987",
										"1": "Mountain-500 Silver, 48",
										"2": "Mountain Bikes",
										"3": "564.9900"
									},
									{
										"0": "988",
										"1": "Mountain-500 Silver, 52",
										"2": "Mountain Bikes",
										"3": "564.9900"
									},
									{
										"0": "989",
										"1": "Mountain-500 Black, 40",
										"2": "Mountain Bikes",
										"3": "539.9900"
									},
									{
										"0": "990",
										"1": "Mountain-500 Black, 42",
										"2": "Mountain Bikes",
										"3": "539.9900"
									},
									{
										"0": "991",
										"1": "Mountain-500 Black, 44",
										"2": "Mountain Bikes",
										"3": "539.9900"
									},
									{
										"0": "992",
										"1": "Mountain-500 Black, 48",
										"2": "Mountain Bikes",
										"3": "539.9900"
									},
									{
										"0": "993",
										"1": "Mountain-500 Black, 52",
										"2": "Mountain Bikes",
										"3": "539.9900"
									},
									{
										"0": "973",
										"1": "Road-350-W Yellow, 40",
										"2": "Road Bikes",
										"3": "1700.9900"
									},
									{
										"0": "974",
										"1": "Road-350-W Yellow, 42",
										"2": "Road Bikes",
										"3": "1700.9900"
									},
									{
										"0": "975",
										"1": "Road-350-W Yellow, 44",
										"2": "Road Bikes",
										"3": "1700.9900"
									},
									{
										"0": "976",
										"1": "Road-350-W Yellow, 48",
										"2": "Road Bikes",
										"3": "1700.9900"
									},
									{
										"0": "977",
										"1": "Road-750 Black, 58",
										"2": "Road Bikes",
										"3": "539.9900"
									},
									{
										"0": "997",
										"1": "Road-750 Black, 44",
										"2": "Road Bikes",
										"3": "539.9900"
									},
									{
										"0": "998",
										"1": "Road-750 Black, 48",
										"2": "Road Bikes",
										"3": "539.9900"
									},
									{
										"0": "999",
										"1": "Road-750 Black, 52",
										"2": "Road Bikes",
										"3": "539.9900"
									},
									{
										"0": "789",
										"1": "Road-250 Red, 44",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "790",
										"1": "Road-250 Red, 48",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "791",
										"1": "Road-250 Red, 52",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "792",
										"1": "Road-250 Red, 58",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "793",
										"1": "Road-250 Black, 44",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "794",
										"1": "Road-250 Black, 48",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "795",
										"1": "Road-250 Black, 52",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "796",
										"1": "Road-250 Black, 58",
										"2": "Road Bikes",
										"3": "2443.3500"
									},
									{
										"0": "797",
										"1": "Road-550-W Yellow, 38",
										"2": "Road Bikes",
										"3": "1120.4900"
									},
									{
										"0": "798",
										"1": "Road-550-W Yellow, 40",
										"2": "Road Bikes",
										"3": "1120.4900"
									},
									{
										"0": "799",
										"1": "Road-550-W Yellow, 42",
										"2": "Road Bikes",
										"3": "1120.4900"
									},
									{
										"0": "800",
										"1": "Road-550-W Yellow, 44",
										"2": "Road Bikes",
										"3": "1120.4900"
									},
									{
										"0": "801",
										"1": "Road-550-W Yellow, 48",
										"2": "Road Bikes",
										"3": "1120.4900"
									},
									{
										"0": "749",
										"1": "Road-150 Red, 62",
										"2": "Road Bikes",
										"3": "3578.2700"
									},
									{
										"0": "750",
										"1": "Road-150 Red, 44",
										"2": "Road Bikes",
										"3": "3578.2700"
									},
									{
										"0": "751",
										"1": "Road-150 Red, 48",
										"2": "Road Bikes",
										"3": "3578.2700"
									},
									{
										"0": "752",
										"1": "Road-150 Red, 52",
										"2": "Road Bikes",
										"3": "3578.2700"
									},
									{
										"0": "753",
										"1": "Road-150 Red, 56",
										"2": "Road Bikes",
										"3": "3578.2700"
									},
									{
										"0": "754",
										"1": "Road-450 Red, 58",
										"2": "Road Bikes",
										"3": "1457.9900"
									},
									{
										"0": "755",
										"1": "Road-450 Red, 60",
										"2": "Road Bikes",
										"3": "1457.9900"
									},
									{
										"0": "756",
										"1": "Road-450 Red, 44",
										"2": "Road Bikes",
										"3": "1457.9900"
									},
									{
										"0": "757",
										"1": "Road-450 Red, 48",
										"2": "Road Bikes",
										"3": "1457.9900"
									},
									{
										"0": "758",
										"1": "Road-450 Red, 52",
										"2": "Road Bikes",
										"3": "1457.9900"
									},
									{
										"0": "759",
										"1": "Road-650 Red, 58",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "760",
										"1": "Road-650 Red, 60",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "761",
										"1": "Road-650 Red, 62",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "762",
										"1": "Road-650 Red, 44",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "763",
										"1": "Road-650 Red, 48",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "764",
										"1": "Road-650 Red, 52",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "765",
										"1": "Road-650 Black, 58",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "766",
										"1": "Road-650 Black, 60",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "767",
										"1": "Road-650 Black, 62",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "768",
										"1": "Road-650 Black, 44",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "769",
										"1": "Road-650 Black, 48",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "770",
										"1": "Road-650 Black, 52",
										"2": "Road Bikes",
										"3": "782.9900"
									},
									{
										"0": "978",
										"1": "Touring-3000 Blue, 44",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "979",
										"1": "Touring-3000 Blue, 50",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "953",
										"1": "Touring-2000 Blue, 60",
										"2": "Touring Bikes",
										"3": "1214.8500"
									},
									{
										"0": "954",
										"1": "Touring-1000 Yellow, 46",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "955",
										"1": "Touring-1000 Yellow, 50",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "956",
										"1": "Touring-1000 Yellow, 54",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "957",
										"1": "Touring-1000 Yellow, 60",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "958",
										"1": "Touring-3000 Blue, 54",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "959",
										"1": "Touring-3000 Blue, 58",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "960",
										"1": "Touring-3000 Blue, 62",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "961",
										"1": "Touring-3000 Yellow, 44",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "962",
										"1": "Touring-3000 Yellow, 50",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "963",
										"1": "Touring-3000 Yellow, 54",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "964",
										"1": "Touring-3000 Yellow, 58",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "965",
										"1": "Touring-3000 Yellow, 62",
										"2": "Touring Bikes",
										"3": "742.3500"
									},
									{
										"0": "966",
										"1": "Touring-1000 Blue, 46",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "967",
										"1": "Touring-1000 Blue, 50",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "968",
										"1": "Touring-1000 Blue, 54",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "969",
										"1": "Touring-1000 Blue, 60",
										"2": "Touring Bikes",
										"3": "2384.0700"
									},
									{
										"0": "970",
										"1": "Touring-2000 Blue, 46",
										"2": "Touring Bikes",
										"3": "1214.8500"
									},
									{
										"0": "971",
										"1": "Touring-2000 Blue, 50",
										"2": "Touring Bikes",
										"3": "1214.8500"
									},
									{
										"0": "972",
										"1": "Touring-2000 Blue, 54",
										"2": "Touring Bikes",
										"3": "1214.8500"
									},
									{
										"0": "946",
										"1": "LL Touring Handlebars",
										"2": "Handlebars",
										"3": "46.0900"
									},
									{
										"0": "947",
										"1": "HL Touring Handlebars",
										"2": "Handlebars",
										"3": "91.5700"
									},
									{
										"0": "808",
										"1": "LL Mountain Handlebars",
										"2": "Handlebars",
										"3": "44.5400"
									},
									{
										"0": "809",
										"1": "ML Mountain Handlebars",
										"2": "Handlebars",
										"3": "61.9200"
									},
									{
										"0": "810",
										"1": "HL Mountain Handlebars",
										"2": "Handlebars",
										"3": "120.2700"
									},
									{
										"0": "811",
										"1": "LL Road Handlebars",
										"2": "Handlebars",
										"3": "44.5400"
									},
									{
										"0": "812",
										"1": "ML Road Handlebars",
										"2": "Handlebars",
										"3": "61.9200"
									},
									{
										"0": "813",
										"1": "HL Road Handlebars",
										"2": "Handlebars",
										"3": "120.2700"
									},
									{
										"0": "994",
										"1": "LL Bottom Bracket",
										"2": "Bottom Brackets",
										"3": "53.9900"
									},
									{
										"0": "995",
										"1": "ML Bottom Bracket",
										"2": "Bottom Brackets",
										"3": "101.2400"
									},
									{
										"0": "996",
										"1": "HL Bottom Bracket",
										"2": "Bottom Brackets",
										"3": "121.4900"
									},
									{
										"0": "948",
										"1": "Front Brakes",
										"2": "Brakes",
										"3": "106.5000"
									},
									{
										"0": "907",
										"1": "Rear Brakes",
										"2": "Brakes",
										"3": "106.5000"
									},
									{
										"0": "952",
										"1": "Chain",
										"2": "Chains",
										"3": "20.2400"
									},
									{
										"0": "949",
										"1": "LL Crankset",
										"2": "Cranksets",
										"3": "175.4900"
									},
									{
										"0": "950",
										"1": "ML Crankset",
										"2": "Cranksets",
										"3": "256.4900"
									},
									{
										"0": "951",
										"1": "HL Crankset",
										"2": "Cranksets",
										"3": "404.9900"
									},
									{
										"0": "945",
										"1": "Front Derailleur",
										"2": "Derailleurs",
										"3": "91.4900"
									},
									{
										"0": "894",
										"1": "Rear Derailleur",
										"2": "Derailleurs",
										"3": "121.4600"
									},
									{
										"0": "802",
										"1": "LL Fork",
										"2": "Forks",
										"3": "148.2200"
									},
									{
										"0": "803",
										"1": "ML Fork",
										"2": "Forks",
										"3": "175.4900"
									},
									{
										"0": "804",
										"1": "HL Fork",
										"2": "Forks",
										"3": "229.4900"
									},
									{
										"0": "805",
										"1": "LL Headset",
										"2": "Headsets",
										"3": "34.2000"
									},
									{
										"0": "806",
										"1": "ML Headset",
										"2": "Headsets",
										"3": "102.2900"
									},
									{
										"0": "807",
										"1": "HL Headset",
										"2": "Headsets",
										"3": "124.7300"
									},
									{
										"0": "739",
										"1": "HL Mountain Frame - Silver, 42",
										"2": "Mountain Frames",
										"3": "1364.5000"
									},
									{
										"0": "740",
										"1": "HL Mountain Frame - Silver, 44",
										"2": "Mountain Frames",
										"3": "1364.5000"
									},
									{
										"0": "741",
										"1": "HL Mountain Frame - Silver, 48",
										"2": "Mountain Frames",
										"3": "1364.5000"
									},
									{
										"0": "742",
										"1": "HL Mountain Frame - Silver, 46",
										"2": "Mountain Frames",
										"3": "1364.5000"
									},
									{
										"0": "743",
										"1": "HL Mountain Frame - Black, 42",
										"2": "Mountain Frames",
										"3": "1349.6000"
									},
									{
										"0": "744",
										"1": "HL Mountain Frame - Black, 44",
										"2": "Mountain Frames",
										"3": "1349.6000"
									},
									{
										"0": "745",
										"1": "HL Mountain Frame - Black, 48",
										"2": "Mountain Frames",
										"3": "1349.6000"
									},
									{
										"0": "746",
										"1": "HL Mountain Frame - Black, 46",
										"2": "Mountain Frames",
										"3": "1349.6000"
									},
									{
										"0": "747",
										"1": "HL Mountain Frame - Black, 38",
										"2": "Mountain Frames",
										"3": "1349.6000"
									},
									{
										"0": "748",
										"1": "HL Mountain Frame - Silver, 38",
										"2": "Mountain Frames",
										"3": "1364.5000"
									},
									{
										"0": "814",
										"1": "ML Mountain Frame - Black, 38",
										"2": "Mountain Frames",
										"3": "348.7600"
									},
									{
										"0": "830",
										"1": "ML Mountain Frame - Black, 40",
										"2": "Mountain Frames",
										"3": "348.7600"
									},
									{
										"0": "831",
										"1": "ML Mountain Frame - Black, 44",
										"2": "Mountain Frames",
										"3": "348.7600"
									},
									{
										"0": "832",
										"1": "ML Mountain Frame - Black, 48",
										"2": "Mountain Frames",
										"3": "348.7600"
									},
									{
										"0": "924",
										"1": "LL Mountain Frame - Black, 42",
										"2": "Mountain Frames",
										"3": "249.7900"
									},
									{
										"0": "925",
										"1": "LL Mountain Frame - Black, 44",
										"2": "Mountain Frames",
										"3": "249.7900"
									},
									{
										"0": "926",
										"1": "LL Mountain Frame - Black, 48",
										"2": "Mountain Frames",
										"3": "249.7900"
									},
									{
										"0": "927",
										"1": "LL Mountain Frame - Black, 52",
										"2": "Mountain Frames",
										"3": "249.7900"
									},
									{
										"0": "917",
										"1": "LL Mountain Frame - Silver, 42",
										"2": "Mountain Frames",
										"3": "264.0500"
									},
									{
										"0": "918",
										"1": "LL Mountain Frame - Silver, 44",
										"2": "Mountain Frames",
										"3": "264.0500"
									},
									{
										"0": "919",
										"1": "LL Mountain Frame - Silver, 48",
										"2": "Mountain Frames",
										"3": "264.0500"
									},
									{
										"0": "920",
										"1": "LL Mountain Frame - Silver, 52",
										"2": "Mountain Frames",
										"3": "264.0500"
									},
									{
										"0": "904",
										"1": "ML Mountain Frame-W - Silver, 40",
										"2": "Mountain Frames",
										"3": "364.0900"
									},
									{
										"0": "905",
										"1": "ML Mountain Frame-W - Silver, 42",
										"2": "Mountain Frames",
										"3": "364.0900"
									},
									{
										"0": "906",
										"1": "ML Mountain Frame-W - Silver, 46",
										"2": "Mountain Frames",
										"3": "364.0900"
									},
									{
										"0": "942",
										"1": "ML Mountain Frame-W - Silver, 38",
										"2": "Mountain Frames",
										"3": "364.0900"
									},
									{
										"0": "943",
										"1": "LL Mountain Frame - Black, 40",
										"2": "Mountain Frames",
										"3": "249.7900"
									},
									{
										"0": "944",
										"1": "LL Mountain Frame - Silver, 40",
										"2": "Mountain Frames",
										"3": "264.0500"
									},
									{
										"0": "935",
										"1": "LL Mountain Pedal",
										"2": "Pedals",
										"3": "40.4900"
									},
									{
										"0": "936",
										"1": "ML Mountain Pedal",
										"2": "Pedals",
										"3": "62.0900"
									},
									{
										"0": "937",
										"1": "HL Mountain Pedal",
										"2": "Pedals",
										"3": "80.9900"
									},
									{
										"0": "938",
										"1": "LL Road Pedal",
										"2": "Pedals",
										"3": "40.4900"
									},
									{
										"0": "939",
										"1": "ML Road Pedal",
										"2": "Pedals",
										"3": "62.0900"
									},
									{
										"0": "940",
										"1": "HL Road Pedal",
										"2": "Pedals",
										"3": "80.9900"
									},
									{
										"0": "941",
										"1": "Touring Pedal",
										"2": "Pedals",
										"3": "80.9900"
									},
									{
										"0": "833",
										"1": "ML Road Frame-W - Yellow, 40",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "834",
										"1": "ML Road Frame-W - Yellow, 42",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "835",
										"1": "ML Road Frame-W - Yellow, 44",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "836",
										"1": "ML Road Frame-W - Yellow, 48",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "837",
										"1": "HL Road Frame - Black, 62",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "838",
										"1": "HL Road Frame - Black, 44",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "839",
										"1": "HL Road Frame - Black, 48",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "840",
										"1": "HL Road Frame - Black, 52",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "822",
										"1": "ML Road Frame-W - Yellow, 38",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "680",
										"1": "HL Road Frame - Black, 58",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "706",
										"1": "HL Road Frame - Red, 58",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "717",
										"1": "HL Road Frame - Red, 62",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "718",
										"1": "HL Road Frame - Red, 44",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "719",
										"1": "HL Road Frame - Red, 48",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "720",
										"1": "HL Road Frame - Red, 52",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "721",
										"1": "HL Road Frame - Red, 56",
										"2": "Road Frames",
										"3": "1431.5000"
									},
									{
										"0": "722",
										"1": "LL Road Frame - Black, 58",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "723",
										"1": "LL Road Frame - Black, 60",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "724",
										"1": "LL Road Frame - Black, 62",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "725",
										"1": "LL Road Frame - Red, 44",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "726",
										"1": "LL Road Frame - Red, 48",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "727",
										"1": "LL Road Frame - Red, 52",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "728",
										"1": "LL Road Frame - Red, 58",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "729",
										"1": "LL Road Frame - Red, 60",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "730",
										"1": "LL Road Frame - Red, 62",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "731",
										"1": "ML Road Frame - Red, 44",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "732",
										"1": "ML Road Frame - Red, 48",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "733",
										"1": "ML Road Frame - Red, 52",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "734",
										"1": "ML Road Frame - Red, 58",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "735",
										"1": "ML Road Frame - Red, 60",
										"2": "Road Frames",
										"3": "594.8300"
									},
									{
										"0": "736",
										"1": "LL Road Frame - Black, 44",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "737",
										"1": "LL Road Frame - Black, 48",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "738",
										"1": "LL Road Frame - Black, 52",
										"2": "Road Frames",
										"3": "337.2200"
									},
									{
										"0": "908",
										"1": "LL Mountain Seat/Saddle",
										"2": "Saddles",
										"3": "27.1200"
									},
									{
										"0": "909",
										"1": "ML Mountain Seat/Saddle",
										"2": "Saddles",
										"3": "39.1400"
									},
									{
										"0": "910",
										"1": "HL Mountain Seat/Saddle",
										"2": "Saddles",
										"3": "52.6400"
									},
									{
										"0": "911",
										"1": "LL Road Seat/Saddle",
										"2": "Saddles",
										"3": "27.1200"
									},
									{
										"0": "912",
										"1": "ML Road Seat/Saddle",
										"2": "Saddles",
										"3": "39.1400"
									},
									{
										"0": "913",
										"1": "HL Road Seat/Saddle",
										"2": "Saddles",
										"3": "52.6400"
									},
									{
										"0": "914",
										"1": "LL Touring Seat/Saddle",
										"2": "Saddles",
										"3": "27.1200"
									},
									{
										"0": "915",
										"1": "ML Touring Seat/Saddle",
										"2": "Saddles",
										"3": "39.1400"
									},
									{
										"0": "916",
										"1": "HL Touring Seat/Saddle",
										"2": "Saddles",
										"3": "52.6400"
									},
									{
										"0": "895",
										"1": "LL Touring Frame - Blue, 50",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "896",
										"1": "LL Touring Frame - Blue, 54",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "897",
										"1": "LL Touring Frame - Blue, 58",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "898",
										"1": "LL Touring Frame - Blue, 62",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "899",
										"1": "LL Touring Frame - Yellow, 44",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "900",
										"1": "LL Touring Frame - Yellow, 50",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "901",
										"1": "LL Touring Frame - Yellow, 54",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "902",
										"1": "LL Touring Frame - Yellow, 58",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "903",
										"1": "LL Touring Frame - Blue, 44",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "885",
										"1": "HL Touring Frame - Yellow, 60",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "886",
										"1": "LL Touring Frame - Yellow, 62",
										"2": "Touring Frames",
										"3": "333.4200"
									},
									{
										"0": "887",
										"1": "HL Touring Frame - Yellow, 46",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "888",
										"1": "HL Touring Frame - Yellow, 50",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "889",
										"1": "HL Touring Frame - Yellow, 54",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "890",
										"1": "HL Touring Frame - Blue, 46",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "891",
										"1": "HL Touring Frame - Blue, 50",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "892",
										"1": "HL Touring Frame - Blue, 54",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "893",
										"1": "HL Touring Frame - Blue, 60",
										"2": "Touring Frames",
										"3": "1003.9100"
									},
									{
										"0": "823",
										"1": "LL Mountain Rear Wheel",
										"2": "Wheels",
										"3": "87.7450"
									},
									{
										"0": "824",
										"1": "ML Mountain Rear Wheel",
										"2": "Wheels",
										"3": "236.0250"
									},
									{
										"0": "825",
										"1": "HL Mountain Rear Wheel",
										"2": "Wheels",
										"3": "327.2150"
									},
									{
										"0": "826",
										"1": "LL Road Rear Wheel",
										"2": "Wheels",
										"3": "112.5650"
									},
									{
										"0": "827",
										"1": "ML Road Rear Wheel",
										"2": "Wheels",
										"3": "275.3850"
									},
									{
										"0": "828",
										"1": "HL Road Rear Wheel",
										"2": "Wheels",
										"3": "357.0600"
									},
									{
										"0": "829",
										"1": "Touring Rear Wheel",
										"2": "Wheels",
										"3": "245.0100"
									},
									{
										"0": "815",
										"1": "LL Mountain Front Wheel",
										"2": "Wheels",
										"3": "60.7450"
									},
									{
										"0": "816",
										"1": "ML Mountain Front Wheel",
										"2": "Wheels",
										"3": "209.0250"
									},
									{
										"0": "817",
										"1": "HL Mountain Front Wheel",
										"2": "Wheels",
										"3": "300.2150"
									},
									{
										"0": "818",
										"1": "LL Road Front Wheel",
										"2": "Wheels",
										"3": "85.5650"
									},
									{
										"0": "819",
										"1": "ML Road Front Wheel",
										"2": "Wheels",
										"3": "248.3850"
									},
									{
										"0": "820",
										"1": "HL Road Front Wheel",
										"2": "Wheels",
										"3": "330.0600"
									},
									{
										"0": "821",
										"1": "Touring Front Wheel",
										"2": "Wheels",
										"3": "218.0100"
									},
									{
										"0": "855",
										"1": "Men's Bib-Shorts, S",
										"2": "Bib-Shorts",
										"3": "89.9900"
									},
									{
										"0": "856",
										"1": "Men's Bib-Shorts, M",
										"2": "Bib-Shorts",
										"3": "89.9900"
									},
									{
										"0": "857",
										"1": "Men's Bib-Shorts, L",
										"2": "Bib-Shorts",
										"3": "89.9900"
									},
									{
										"0": "712",
										"1": "AWC Logo Cap",
										"2": "Caps",
										"3": "8.9900"
									},
									{
										"0": "858",
										"1": "Half-Finger Gloves, S",
										"2": "Gloves",
										"3": "24.4900"
									},
									{
										"0": "859",
										"1": "Half-Finger Gloves, M",
										"2": "Gloves",
										"3": "24.4900"
									},
									{
										"0": "860",
										"1": "Half-Finger Gloves, L",
										"2": "Gloves",
										"3": "24.4900"
									},
									{
										"0": "861",
										"1": "Full-Finger Gloves, S",
										"2": "Gloves",
										"3": "37.9900"
									},
									{
										"0": "862",
										"1": "Full-Finger Gloves, M",
										"2": "Gloves",
										"3": "37.9900"
									},
									{
										"0": "863",
										"1": "Full-Finger Gloves, L",
										"2": "Gloves",
										"3": "37.9900"
									},
									{
										"0": "713",
										"1": "Long-Sleeve Logo Jersey, S",
										"2": "Jerseys",
										"3": "49.9900"
									},
									{
										"0": "714",
										"1": "Long-Sleeve Logo Jersey, M",
										"2": "Jerseys",
										"3": "49.9900"
									},
									{
										"0": "715",
										"1": "Long-Sleeve Logo Jersey, L",
										"2": "Jerseys",
										"3": "49.9900"
									},
									{
										"0": "716",
										"1": "Long-Sleeve Logo Jersey, XL",
										"2": "Jerseys",
										"3": "49.9900"
									},
									{
										"0": "881",
										"1": "Short-Sleeve Classic Jersey, S",
										"2": "Jerseys",
										"3": "53.9900"
									},
									{
										"0": "882",
										"1": "Short-Sleeve Classic Jersey, M",
										"2": "Jerseys",
										"3": "53.9900"
									},
									{
										"0": "883",
										"1": "Short-Sleeve Classic Jersey, L",
										"2": "Jerseys",
										"3": "53.9900"
									},
									{
										"0": "884",
										"1": "Short-Sleeve Classic Jersey, XL",
										"2": "Jerseys",
										"3": "53.9900"
									},
									{
										"0": "867",
										"1": "Women's Mountain Shorts, S",
										"2": "Shorts",
										"3": "69.9900"
									},
									{
										"0": "868",
										"1": "Women's Mountain Shorts, M",
										"2": "Shorts",
										"3": "69.9900"
									},
									{
										"0": "869",
										"1": "Women's Mountain Shorts, L",
										"2": "Shorts",
										"3": "69.9900"
									},
									{
										"0": "841",
										"1": "Men's Sports Shorts, S",
										"2": "Shorts",
										"3": "59.9900"
									},
									{
										"0": "849",
										"1": "Men's Sports Shorts, M",
										"2": "Shorts",
										"3": "59.9900"
									},
									{
										"0": "850",
										"1": "Men's Sports Shorts, L",
										"2": "Shorts",
										"3": "59.9900"
									},
									{
										"0": "851",
										"1": "Men's Sports Shorts, XL",
										"2": "Shorts",
										"3": "59.9900"
									},
									{
										"0": "709",
										"1": "Mountain Bike Socks, M",
										"2": "Socks",
										"3": "9.5000"
									},
									{
										"0": "710",
										"1": "Mountain Bike Socks, L",
										"2": "Socks",
										"3": "9.5000"
									},
									{
										"0": "874",
										"1": "Racing Socks, M",
										"2": "Socks",
										"3": "8.9900"
									},
									{
										"0": "875",
										"1": "Racing Socks, L",
										"2": "Socks",
										"3": "8.9900"
									},
									{
										"0": "852",
										"1": "Women's Tights, S",
										"2": "Tights",
										"3": "74.9900"
									},
									{
										"0": "853",
										"1": "Women's Tights, M",
										"2": "Tights",
										"3": "74.9900"
									},
									{
										"0": "854",
										"1": "Women's Tights, L",
										"2": "Tights",
										"3": "74.9900"
									},
									{
										"0": "864",
										"1": "Classic Vest, S",
										"2": "Vests",
										"3": "63.5000"
									},
									{
										"0": "865",
										"1": "Classic Vest, M",
										"2": "Vests",
										"3": "63.5000"
									},
									{
										"0": "866",
										"1": "Classic Vest, L",
										"2": "Vests",
										"3": "63.5000"
									},
									{
										"0": "876",
										"1": "Hitch Rack - 4-Bike",
										"2": "Bike Racks",
										"3": "120.0000"
									},
									{
										"0": "879",
										"1": "All-Purpose Bike Stand",
										"2": "Bike Stands",
										"3": "159.0000"
									},
									{
										"0": "870",
										"1": "Water Bottle - 30 oz.",
										"2": "Bottles and Cages",
										"3": "4.9900"
									},
									{
										"0": "871",
										"1": "Mountain Bottle Cage",
										"2": "Bottles and Cages",
										"3": "9.9900"
									},
									{
										"0": "872",
										"1": "Road Bottle Cage",
										"2": "Bottles and Cages",
										"3": "8.9900"
									},
									{
										"0": "877",
										"1": "Bike Wash - Dissolver",
										"2": "Cleaners",
										"3": "7.9500"
									},
									{
										"0": "878",
										"1": "Fender Set - Mountain",
										"2": "Fenders",
										"3": "21.9800"
									},
									{
										"0": "711",
										"1": "Sport-100 Helmet, Blue",
										"2": "Helmets",
										"3": "34.9900"
									},
									{
										"0": "707",
										"1": "Sport-100 Helmet, Red",
										"2": "Helmets",
										"3": "34.9900"
									},
									{
										"0": "708",
										"1": "Sport-100 Helmet, Black",
										"2": "Helmets",
										"3": "34.9900"
									},
									{
										"0": "880",
										"1": "Hydration Pack - 70 oz.",
										"2": "Hydration Packs",
										"3": "54.9900"
									},
									{
										"0": "846",
										"1": "Taillights - Battery-Powered",
										"2": "Lights",
										"3": "13.9900"
									},
									{
										"0": "847",
										"1": "Headlights - Dual-Beam",
										"2": "Lights",
										"3": "34.9900"
									},
									{
										"0": "848",
										"1": "Headlights - Weatherproof",
										"2": "Lights",
										"3": "44.9900"
									},
									{
										"0": "843",
										"1": "Cable Lock",
										"2": "Locks",
										"3": "25.0000"
									},
									{
										"0": "842",
										"1": "Touring-Panniers, Large",
										"2": "Panniers",
										"3": "125.0000"
									},
									{
										"0": "844",
										"1": "Minipump",
										"2": "Pumps",
										"3": "19.9900"
									},
									{
										"0": "845",
										"1": "Mountain Pump",
										"2": "Pumps",
										"3": "24.9900"
									},
									{
										"0": "873",
										"1": "Patch Kit/8 Patches",
										"2": "Tires and Tubes",
										"3": "2.2900"
									},
									{
										"0": "921",
										"1": "Mountain Tire Tube",
										"2": "Tires and Tubes",
										"3": "4.9900"
									},
									{
										"0": "922",
										"1": "Road Tire Tube",
										"2": "Tires and Tubes",
										"3": "3.9900"
									},
									{
										"0": "923",
										"1": "Touring Tire Tube",
										"2": "Tires and Tubes",
										"3": "4.9900"
									},
									{
										"0": "928",
										"1": "LL Mountain Tire",
										"2": "Tires and Tubes",
										"3": "24.9900"
									},
									{
										"0": "929",
										"1": "ML Mountain Tire",
										"2": "Tires and Tubes",
										"3": "29.9900"
									},
									{
										"0": "930",
										"1": "HL Mountain Tire",
										"2": "Tires and Tubes",
										"3": "35.0000"
									},
									{
										"0": "931",
										"1": "LL Road Tire",
										"2": "Tires and Tubes",
										"3": "21.4900"
									},
									{
										"0": "932",
										"1": "ML Road Tire",
										"2": "Tires and Tubes",
										"3": "24.9900"
									},
									{
										"0": "933",
										"1": "HL Road Tire",
										"2": "Tires and Tubes",
										"3": "32.6000"
									},
									{
										"0": "934",
										"1": "Touring Tire",
										"2": "Tires and Tubes",
										"3": "28.9900"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "ProductID",
										"type": "string"
									},
									{
										"key": "1",
										"name": "ProductName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "Category",
										"type": "string"
									},
									{
										"key": "3",
										"name": "ListPrice",
										"type": "string"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"146b7b03-1f90-4ce3-bbce-ce4b8b4a7931": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "Dev1",
										"1": "ok"
									},
									{
										"0": "Dev1",
										"1": "ok"
									},
									{
										"0": "Dev1",
										"1": "ok"
									},
									{
										"0": "Dev2",
										"1": "error"
									},
									{
										"0": "Dev1",
										"1": "ok"
									},
									{
										"0": "Dev1",
										"1": "error"
									},
									{
										"0": "Dev2",
										"1": "ok"
									},
									{
										"0": "Dev2",
										"1": "error"
									},
									{
										"0": "Dev1",
										"1": "ok"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "device",
										"type": "string"
									},
									{
										"key": "1",
										"name": "status",
										"type": "string"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/40911347-4086-47ba-a836-c020ead78f4d/resourceGroups/dp203-2zy8loi/providers/Microsoft.Synapse/workspaces/synapse2zy8loi/bigDataPools/spark2zy8loi",
				"name": "spark2zy8loi",
				"type": "Spark",
				"endpoint": "https://synapse2zy8loi.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark2zy8loi",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "3.1",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://files@datalake2zy8loi.dfs.core.windows.net/products/products.csv', format='csv'\r\n",
					"## If header exists uncomment line below\r\n",
					", header=True\r\n",
					")\r\n",
					"display(df.limit(10))"
				],
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"delta_table_path = \"/delta/products-delta\"\r\n",
					"df.write.format(\"delta\").save(delta_table_path)"
				],
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from delta.tables import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"##Create a deltaTable object\r\n",
					"deltaTable = DeltaTable.forPath(spark, delta_table_path)\r\n",
					"\r\n",
					"##Update the table (reduce price of product 771 by 10%)\r\n",
					"deltaTable.update(\r\n",
					"    condition = \"ProductID == 771\",\r\n",
					"    set = { \"ListPrice\": \"ListPrice * 0.9\" })\r\n",
					"\r\n",
					"##View the updated data as a dataframe\r\n",
					"deltaTable.toDF().show(10)"
				],
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"new_df = spark.read.format(\"delta\").load(delta_table_path)\r\n",
					"new_df.show(10)"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"new_df = spark.read.format(\"delta\").option(\"versionAsOf\", 0).load(delta_table_path)\r\n",
					"new_df.show(10)"
				],
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"display(new_df)"
				],
				"execution_count": 7
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"deltaTable.history(10).show(20, False, True)"
				],
				"execution_count": 8
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"spark.sql(\"CREATE DATABASE AdventureWorks\")\r\n",
					"spark.sql(\"CREATE TABLE AdventureWorks.ProductsExternal USING DELTA LOCATION '{0}'\".format(delta_table_path))\r\n",
					"spark.sql(\"DESCRIBE EXTENDED AdventureWorks.ProductsExternal\").show(truncate=False)"
				],
				"execution_count": 9
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"SELECT * FROM ProductsExternal;"
				],
				"execution_count": 11
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					""
				]
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Create a Managed table"
				]
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.write.format(\"delta\").saveAsTable(\"AdventureWorks.ProductsManaged\")\r\n",
					"spark.sql(\"DESCRIBE EXTENDED AdventureWorks.ProductsManaged\").show(truncate=False)"
				],
				"execution_count": 12
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"SELECT * FROM ProductsManaged;"
				],
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"SHOW TABLES;"
				],
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"DROP TABLE IF EXISTS ProductsExternal;\r\n",
					"DROP TABLE IF EXISTS ProductsManaged;"
				],
				"execution_count": 17
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"CREATE TABLE Products\r\n",
					"USING DELTA\r\n",
					"LOCATION '/delta/products-delta';"
				],
				"execution_count": 18
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"USE AdventureWorks;\r\n",
					"\r\n",
					"SELECT * FROM Products;"
				],
				"execution_count": 19
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from notebookutils import mssparkutils\r\n",
					"from pyspark.sql.types import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"# Create a folder\r\n",
					"inputPath = '/data/'\r\n",
					"mssparkutils.fs.mkdirs(inputPath)\r\n",
					"\r\n",
					"# Create a stream that reads data from the folder, using a JSON schema\r\n",
					"jsonSchema = StructType([\r\n",
					"StructField(\"device\", StringType(), False),\r\n",
					"StructField(\"status\", StringType(), False)\r\n",
					"])\r\n",
					"iotstream = spark.readStream.schema(jsonSchema).option(\"maxFilesPerTrigger\", 1).json(inputPath)\r\n",
					"\r\n",
					"# Write some event data to the folder\r\n",
					"device_data = '''{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev2\",\"status\":\"error\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"error\"}\r\n",
					"{\"device\":\"Dev2\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev2\",\"status\":\"error\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}'''\r\n",
					"mssparkutils.fs.put(inputPath + \"data.txt\", device_data, True)\r\n",
					"print(\"Source stream created...\")"
				],
				"execution_count": 20
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Write the stream to a delta table\r\n",
					"delta_stream_table_path = '/delta/iotdevicedata'\r\n",
					"checkpointpath = '/delta/checkpoint'\r\n",
					"deltastream = iotstream.writeStream.format(\"delta\").option(\"checkpointLocation\", checkpointpath).start(delta_stream_table_path)\r\n",
					"print(\"Streaming to delta sink...\")"
				],
				"execution_count": 22
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Read the data in delta format into a dataframe\r\n",
					"df = spark.read.format(\"delta\").load(delta_stream_table_path)\r\n",
					"display(df)"
				],
				"execution_count": 23
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# create a catalog table based on the streaming sink\r\n",
					"spark.sql(\"CREATE TABLE IotDeviceData USING DELTA LOCATION '{0}'\".format(delta_stream_table_path))"
				],
				"execution_count": 24
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"SELECT * FROM IotDeviceData;"
				],
				"execution_count": 25
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Add more data to the source stream\r\n",
					"more_data = '''{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"error\"}\r\n",
					"{\"device\":\"Dev2\",\"status\":\"error\"}\r\n",
					"{\"device\":\"Dev1\",\"status\":\"ok\"}'''\r\n",
					"\r\n",
					"mssparkutils.fs.put(inputPath + \"more-data.txt\", more_data, True)"
				],
				"execution_count": 26
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"SELECT * FROM IotDeviceData;"
				],
				"execution_count": 27
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"deltastream.stop()"
				],
				"execution_count": 28
			}
		]
	}
}